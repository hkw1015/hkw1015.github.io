import{_ as s,Z as n,$ as a,a5 as e}from"./framework-1fb77053.js";const t={},p=e(`<h2 id="_1-什么是约束" tabindex="-1"><a class="header-anchor" href="#_1-什么是约束" aria-hidden="true">#</a> 1. 什么是约束？</h2><h3 id="_1-1-含义" tabindex="-1"><a class="header-anchor" href="#_1-1-含义" aria-hidden="true">#</a> 1.1 含义</h3><ul><li>为了保证数据的一致性和完整性，SQL 规范以约束的方式对表数据进行额外的条件限制</li><li>约束是表级的强制规定</li><li>可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后也可以（通过 ALTER TABLE 语句）</li></ul><h3 id="_1-2-约束分类" tabindex="-1"><a class="header-anchor" href="#_1-2-约束分类" aria-hidden="true">#</a> 1.2 约束分类</h3><p>有以下六大约束：</p><ul><li><strong>NOT NULL</strong>：非空约束，规定某个字段不能为空，比如姓名，学号等</li><li><strong>UNIQUE</strong>：唯一约束，规定某个字段在整个表中是唯一的，可以为空，比如座位号</li><li><strong>PRIMARY KEY</strong>：主键约束(非空且唯一)，比如学号，员工编号</li><li><strong>FOREIGN KEY</strong>：外键约束，用于限制两个表的关系 <ul><li>(在从表中添加外键约束，用于引用主表中某列的值，比如学生表的专业编号，员工表的部门编号)</li></ul></li><li><strong>CHECK</strong>：检查约束(MySQL 不支持，但也不报错)，比如年龄，性别</li><li><strong>DEFAULT</strong>：默认值，用于保证该字段有默认值，比如性别、删除标识</li></ul><h3 id="_1-3-约束的添加分类" tabindex="-1"><a class="header-anchor" href="#_1-3-约束的添加分类" aria-hidden="true">#</a> 1.3 约束的添加分类</h3><ul><li><p>①列级约束：只能作用在一个列上，跟在列定义的后面</p><ul><li><strong>六大约束都支持，但外键约束没有效果</strong></li></ul></li><li><p>②表级约束：可以作用在多个列上，不与列一起，而是单独定义</p><ul><li><p><strong>除了非空和默认，其他都支持</strong></p></li><li><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名 {
    字段名 字段类型 列级约束<span class="token punctuation">,</span>
    字段名 字段类型<span class="token punctuation">,</span>
    表级约束
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="_2-创建表时添加约束" tabindex="-1"><a class="header-anchor" href="#_2-创建表时添加约束" aria-hidden="true">#</a> 2. 创建表时添加约束</h2><h3 id="_2-1-添加列级约束" tabindex="-1"><a class="header-anchor" href="#_2-1-添加列级约束" aria-hidden="true">#</a> 2.1 添加列级约束</h3><p><strong>语法</strong>：直接在字段名和类型后面追加约束类型即可，只支持：默认、非空、主键、唯一</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> students<span class="token punctuation">;</span>
<span class="token keyword">USE</span> students<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stuinfo <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span><span class="token comment"># 主键</span>
    stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token comment"># 非空</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">&#39;男&#39;</span> <span class="token operator">OR</span> gender<span class="token operator">=</span><span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 检查约束</span>
    seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span><span class="token comment"># 唯一</span>
    age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span> <span class="token comment"># 默认值</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 查看stuinfo中的所有索引，包括主键、外键、唯一</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> stuinfo<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>索引查看结果如下：</p><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210910164856785.png" alt="image-20210910164856785" tabindex="0" loading="lazy"><figcaption>image-20210910164856785</figcaption></figure><h3 id="_2-2-添加表级约束" tabindex="-1"><a class="header-anchor" href="#_2-2-添加表级约束" aria-hidden="true">#</a> 2.2 添加表级约束</h3><p><strong>语法</strong></p><p>在各个字段的最下面：</p><p>【CONSTRAINT 约束名】 约束类型(字段名)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> stuinfo<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> major <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    majorName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stuinfo <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token comment"># 非空</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    seat <span class="token keyword">INT</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span><span class="token punctuation">,</span><span class="token comment"># 默认值</span>
    majorid <span class="token keyword">INT</span><span class="token punctuation">,</span>
    
    <span class="token keyword">CONSTRAINT</span> pk <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 主键</span>
    <span class="token keyword">CONSTRAINT</span> uq <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>seat<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 唯一</span>
    <span class="token keyword">CONSTRAINT</span> ck <span class="token keyword">CHECK</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">&#39;男&#39;</span> <span class="token operator">OR</span> gender<span class="token operator">=</span><span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 检查</span>
    <span class="token keyword">CONSTRAINT</span> fk_stuinfo_major <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment"># 外键</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 查看stuinfo中的所有索引，包括主键、外键、唯一</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> stuinfo<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>索引查看结果如下：</p><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210910165127128.png" alt="image-20210910165127128" tabindex="0" loading="lazy"><figcaption>image-20210910165127128</figcaption></figure><h3 id="_2-3-通用的写法" tabindex="-1"><a class="header-anchor" href="#_2-3-通用的写法" aria-hidden="true">#</a> 2.3 通用的写法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> stuinfo <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span><span class="token comment"># 主键</span>
    stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token comment"># 非空</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">&#39;男&#39;</span> <span class="token operator">OR</span> gender<span class="token operator">=</span><span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 检查</span>
    seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span><span class="token comment"># 唯一</span>
    age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span><span class="token punctuation">,</span><span class="token comment"># 默认值</span>
    majorid <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">CONSTRAINT</span> fk_stuinfo_major <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment"># 外键</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-修改表时添加约束" tabindex="-1"><a class="header-anchor" href="#_3-修改表时添加约束" aria-hidden="true">#</a> 3. 修改表时添加约束</h2><h3 id="_3-1-语法" tabindex="-1"><a class="header-anchor" href="#_3-1-语法" aria-hidden="true">#</a> 3.1 语法</h3><ul><li><p><strong>添加列级约束</strong></p><ul><li><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> 字段名 字段类型 新约束<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>添加表级约束</strong></p><ul><li><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span> 【<span class="token keyword">CONSTRAINT</span> 约束名】 约束类型<span class="token punctuation">(</span>字段名<span class="token punctuation">)</span> 【外键的引用】<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="_3-2-示例" tabindex="-1"><a class="header-anchor" href="#_3-2-示例" aria-hidden="true">#</a> 3.2 示例</h3><p><strong>（1）添加非空约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（2）添加默认约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（3）添加主键约束</strong></p><p>①列级约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>②表级约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（4）添加唯一约束</strong></p><p>①列级约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>②表级约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>seat<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（5）添加外键约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_4-修改表时删除约束" tabindex="-1"><a class="header-anchor" href="#_4-修改表时删除约束" aria-hidden="true">#</a> 4. 修改表时删除约束</h2><p><strong>（1）删除非空约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（2）删除默认约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> age <span class="token keyword">INT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（3）删除主键约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（4）删除唯一约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># seat为对应的索引名称，可通过SHOW INDEX FROM stuinfo;语句进行查看</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> seat<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>（5）删除外键约束</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> fk_stuinfo_major<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_5-主键和唯一的对比" tabindex="-1"><a class="header-anchor" href="#_5-主键和唯一的对比" aria-hidden="true">#</a> 5. 主键和唯一的对比</h2><table><thead><tr><th style="text-align:center;"></th><th style="text-align:center;">是否保证唯一性</th><th style="text-align:center;">是否允许为空</th><th style="text-align:center;">一个表中是否允许有多个</th><th style="text-align:center;">是否允许组合</th></tr></thead><tbody><tr><td style="text-align:center;">主键(PRIMARY KEY)</td><td style="text-align:center;">√</td><td style="text-align:center;">×</td><td style="text-align:center;">至多有一个</td><td style="text-align:center;">√，但不推荐</td></tr><tr><td style="text-align:center;">唯一(UNIQUE)</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">可以有多个</td><td style="text-align:center;">√，但不推荐</td></tr></tbody></table><h2 id="_6-外键的特点" tabindex="-1"><a class="header-anchor" href="#_6-外键的特点" aria-hidden="true">#</a> 6. 外键的特点</h2><ul><li>要求在从表设置外键关系</li><li>从表外键列的类型和主表的关联列的类型要求一致或兼容，名称无要求</li><li>主表的关联列必须是一个 KEY (一般是主键或唯一)</li><li>插入数据时，先插入主表，再插入从表；删除数据时，先删除从表，再删除主表</li></ul>`,58),o=[p];function l(c,i){return n(),a("div",null,o)}const r=s(t,[["render",l],["__file","mysql-basic-9.html.vue"]]);export{r as default};
