import{_ as s,Z as n,$ as a,a5 as e}from"./framework-1fb77053.js";const p={},t=e(`<h2 id="_1-什么是存储过程" tabindex="-1"><a class="header-anchor" href="#_1-什么是存储过程" aria-hidden="true">#</a> 1. 什么是存储过程</h2><h3 id="_1-1-含义" tabindex="-1"><a class="header-anchor" href="#_1-1-含义" aria-hidden="true">#</a> 1.1 含义</h3><p>事先经过编译并存储在数据库中的一段 sql 语句的集合（类似于 Java 中的方法）</p><h3 id="_1-2-好处" tabindex="-1"><a class="header-anchor" href="#_1-2-好处" aria-hidden="true">#</a> 1.2 好处</h3><p>（1）简化开发人员很多工作</p><p>（2）减少数据在数据库和应用服务器之间的传输</p><p>（3）提高了数据处理的效率</p><h2 id="_2-创建和调用存储过程" tabindex="-1"><a class="header-anchor" href="#_2-创建和调用存储过程" aria-hidden="true">#</a> 2. 创建和调用存储过程</h2><h3 id="_2-1-语法" tabindex="-1"><a class="header-anchor" href="#_2-1-语法" aria-hidden="true">#</a> 2.1 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    存储过程体<span class="token punctuation">(</span>一组合法有效的<span class="token keyword">SQL</span>语句<span class="token punctuation">)</span>
<span class="token keyword">END</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-注意" tabindex="-1"><a class="header-anchor" href="#_2-2-注意" aria-hidden="true">#</a> 2.2 注意</h3><p><strong>参数列表包含三部分：</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>参数模式 参数名 参数类型
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>举例：</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">IN</span> stu_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>参数模式说明：</strong></p><ul><li>IN：该参数作为作为输入，也就是该参数需要调用方传入值</li><li>OUT：该参数可以作为输出，也就是该参数可以作为返回值</li><li>INOUT：该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又可以返回值</li></ul><p>（1）如果存储过程仅仅只有一句话，BEGIN END 可以省略</p><p>（2）存储过程体中的每条 SQL 语句的结尾要求必须加分号</p><p>（3）存储过程的结尾可以使用 <strong>DELIMITER</strong> 重新设置</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELIMITER</span> 结束标记（命令行可用）
举例：
<span class="token keyword">DELIMITER</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-调用存储过程" tabindex="-1"><a class="header-anchor" href="#_2-3-调用存储过程" aria-hidden="true">#</a> 2.3 调用存储过程</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CALL</span> 存储过程名<span class="token punctuation">(</span>实参列表<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-4-示例" tabindex="-1"><a class="header-anchor" href="#_2-4-示例" aria-hidden="true">#</a> 2.4 示例</h3><p><strong>（1）空参列表</strong></p><p>案例：插入到admin表中5条记录</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELIMITER</span> $
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">\`</span>password<span class="token punctuation">\`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span><span class="token string">&#39;jack&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token string">&#39;tom&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token string">&#39;lilei&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token string">&#39;rose&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token string">&#39;jerry&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085117296.png" alt="image-20210911085117296" tabindex="0" loading="lazy"><figcaption>image-20210911085117296</figcaption></figure><p><strong>（2）带 IN 模式的存储过程</strong></p><p>案例1：创建存储过程实现，根据女神名，查询对应的男神信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp2<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> boys <span class="token keyword">AS</span> bo <span class="token keyword">JOIN</span> beauty <span class="token keyword">AS</span> b
	<span class="token keyword">ON</span> bo<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>boyfriend_id
	<span class="token keyword">WHERE</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token operator">=</span> beautyName<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085211116.png" alt="image-20210911085211116" tabindex="0" loading="lazy"><figcaption>image-20210911085211116</figcaption></figure><p>案例2：创建存储过程实现，用户是否登录成功</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp3<span class="token punctuation">(</span><span class="token operator">IN</span> username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">IN</span> password <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">DECLARE</span> result <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> result
	<span class="token keyword">FROM</span> admin
	<span class="token keyword">WHERE</span> admin<span class="token punctuation">.</span>username <span class="token operator">=</span> username <span class="token operator">AND</span> admin<span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
	<span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>result <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&#39;登录成功&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;登陆失败&#39;</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 结果<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085330109.png" alt="image-20210911085330109" tabindex="0" loading="lazy"><figcaption>image-20210911085330109</figcaption></figure><p><strong>（3）带 OUT 模式的存储过程</strong></p><p>案例1：根据女神名，返回对应男神名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp4<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> bName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span>boyName <span class="token keyword">INTO</span> bName
	<span class="token keyword">FROM</span> boys <span class="token keyword">AS</span> bo
	<span class="token keyword">JOIN</span> beauty <span class="token keyword">AS</span> b <span class="token keyword">ON</span> bo<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>boyfriend_id
	<span class="token keyword">WHERE</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token operator">=</span> beautyName<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085650804.png" alt="image-20210911085650804" tabindex="0" loading="lazy"><figcaption>image-20210911085650804</figcaption></figure><p>案例2：根据女神名，返回对应男神名和男神魅力值</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp5<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> bName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> userCP <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span>boyName<span class="token punctuation">,</span>bo<span class="token punctuation">.</span>userCP <span class="token keyword">INTO</span> bName<span class="token punctuation">,</span>userCP
	<span class="token keyword">FROM</span> boys <span class="token keyword">AS</span> bo
	<span class="token keyword">JOIN</span> beauty <span class="token keyword">AS</span> b <span class="token keyword">ON</span> bo<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>boyfriend_id
	<span class="token keyword">WHERE</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token operator">=</span> beautyName<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085719157.png" alt="image-20210911085719157" tabindex="0" loading="lazy"><figcaption>image-20210911085719157</figcaption></figure><p><strong>（4）带 INOUT 模式的存储过程</strong></p><p>案例：传入a和b两个值，最终a和b都翻倍并返回</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp6<span class="token punctuation">(</span><span class="token keyword">INOUT</span> a <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token keyword">INOUT</span> b <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SET</span> a <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">SET</span> b <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911085830789.png" alt="image-20210911085830789" tabindex="0" loading="lazy"><figcaption>image-20210911085830789</figcaption></figure><h2 id="_3-存储过程的删除" tabindex="-1"><a class="header-anchor" href="#_3-存储过程的删除" aria-hidden="true">#</a> 3. 存储过程的删除</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">;</span><span class="token comment"># 一次只能删除一个</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_4-查看存储过程的信息" tabindex="-1"><a class="header-anchor" href="#_4-查看存储过程的信息" aria-hidden="true">#</a> 4. 查看存储过程的信息</h2><h3 id="_4-1-语法" tabindex="-1"><a class="header-anchor" href="#_4-1-语法" aria-hidden="true">#</a> 4.1 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-2-示例" tabindex="-1"><a class="header-anchor" href="#_4-2-示例" aria-hidden="true">#</a> 4.2 示例</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看结果：</p><figure><img src="https://pet-hkw.oss-cn-shenzhen.aliyuncs.com/image/new_blog_system/mysql/image-20210911084916194.png" alt="image-20210911084916194" tabindex="0" loading="lazy"><figcaption>image-20210911084916194</figcaption></figure>`,55),o=[t];function i(l,c){return n(),a("div",null,o)}const r=s(p,[["render",i],["__file","mysql-basic-13.html.vue"]]);export{r as default};
