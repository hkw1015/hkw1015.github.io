import{_ as s,Z as n,$ as a,a5 as e}from"./framework-1fb77053.js";const p={},l=e(`<h2 id="_1-什么是视图" tabindex="-1"><a class="header-anchor" href="#_1-什么是视图" aria-hidden="true">#</a> 1. 什么是视图</h2><h3 id="_1-1-概念" tabindex="-1"><a class="header-anchor" href="#_1-1-概念" aria-hidden="true">#</a> 1.1 概念</h3><p>MySQL 从 5.0.1 版本开始提供视图功能。一种虚拟存在的表，行和列的数据来自定义视图的查询中使用的表，并且是在使用视图时<strong>动态生成的</strong>，<strong>只保存了 sql 逻辑，不保存查询结果</strong></p><h3 id="_1-2-应用场景" tabindex="-1"><a class="header-anchor" href="#_1-2-应用场景" aria-hidden="true">#</a> 1.2 应用场景</h3><p>（1）多个地方用到同样的查询结果</p><p>（2）该查询结果使用的sql语句较复杂</p><h3 id="_1-3-视图的好处" tabindex="-1"><a class="header-anchor" href="#_1-3-视图的好处" aria-hidden="true">#</a> 1.3 视图的好处</h3><p>（1）重用 SQL 语句</p><p>（2）简化复杂的 SQL 操作，不必知道它的查询细节</p><p>（3）保护数据，提高安全性</p><h2 id="_2-创建或修改视图" tabindex="-1"><a class="header-anchor" href="#_2-创建或修改视图" aria-hidden="true">#</a> 2. 创建或修改视图</h2><h3 id="_2-1-创建视图" tabindex="-1"><a class="header-anchor" href="#_2-1-创建视图" aria-hidden="true">#</a> 2.1 创建视图</h3><h4 id="_1-语法" tabindex="-1"><a class="header-anchor" href="#_1-语法" aria-hidden="true">#</a> （1）语法</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> 视图名
<span class="token keyword">AS</span>
查询语句<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-示例" tabindex="-1"><a class="header-anchor" href="#_2-示例" aria-hidden="true">#</a> （2）示例</h4><p>示例1：查询姓名中包含a字符的员工名、部门名和工种信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># （1）创建视图</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>job_title <span class="token keyword">FROM</span> employees <span class="token keyword">AS</span> e
<span class="token keyword">JOIN</span> departments <span class="token keyword">AS</span> d <span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">JOIN</span> jobs <span class="token keyword">AS</span> j <span class="token keyword">ON</span> e<span class="token punctuation">.</span>job_id <span class="token operator">=</span> j<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>

<span class="token comment"># （2）使用</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv1 <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">&#39;%a%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例2：查询各部门的平均工资级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># （1）创建视图</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv2
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">AS</span> ag<span class="token punctuation">,</span>department_id <span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>
<span class="token comment"># （2）使用</span>
<span class="token keyword">SELECT</span> myv2<span class="token punctuation">.</span>ag<span class="token punctuation">,</span>grade_level <span class="token keyword">FROM</span> myv2
<span class="token keyword">JOIN</span> job_grades <span class="token keyword">AS</span> jg
<span class="token keyword">ON</span> myv2<span class="token punctuation">.</span>ag <span class="token operator">BETWEEN</span> jg<span class="token punctuation">.</span>lowest_sal <span class="token operator">AND</span> jg<span class="token punctuation">.</span>highest_sal<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例3：查询平均工资最低的部门信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># 复用视图myv2</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> departments <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> department_id <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token comment"># 默认 asc 排序，从小到大，取的第一个就是最低</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例4：查询平均工资最低的部门名和工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># （1）创建视图</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment"># （2）使用</span>
<span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>myv3<span class="token punctuation">.</span>ag <span class="token keyword">FROM</span> myv3
<span class="token keyword">JOIN</span> departments <span class="token keyword">AS</span> d <span class="token keyword">ON</span> myv3<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-修改视图" tabindex="-1"><a class="header-anchor" href="#_2-2-修改视图" aria-hidden="true">#</a> 2.2 修改视图</h3><h4 id="_1-方式一" tabindex="-1"><a class="header-anchor" href="#_1-方式一" aria-hidden="true">#</a> （1）方式一</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> 视图名
<span class="token keyword">AS</span>
查询语句<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-方式二" tabindex="-1"><a class="header-anchor" href="#_2-方式二" aria-hidden="true">#</a> （2）方式二</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> 视图名
<span class="token keyword">AS</span>
查询语句<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-注意点" tabindex="-1"><a class="header-anchor" href="#_3-注意点" aria-hidden="true">#</a> （3）注意点</h4><p><strong>视图的可更新性（指的<span style="color:blue;">增删改</span>）和视图中查询的定义有关系，以下类型的视图是不能更新的：</strong></p><ul><li><p>①包含以下关键字的 sql 语句：分组函数、distinct、group by、having、union 或 union all</p></li><li><p>②常量视图</p></li><li><p>③SELECT 中包含子查询</p></li><li><p>④JOIN</p></li><li><p>⑤FROM 一个不能更新的视图</p></li><li><p>⑥WHERE 子句的子查询引用了 FROM 子句中的表</p></li></ul><h2 id="_3-视图的查看和删除" tabindex="-1"><a class="header-anchor" href="#_3-视图的查看和删除" aria-hidden="true">#</a> 3. 视图的查看和删除</h2><h3 id="_3-1-查看" tabindex="-1"><a class="header-anchor" href="#_3-1-查看" aria-hidden="true">#</a> 3.1 查看</h3><p>（1）方式一</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DESC</span> 视图名<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>（2）方式二（★）</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> 视图名<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-2-删除" tabindex="-1"><a class="header-anchor" href="#_3-2-删除" aria-hidden="true">#</a> 3.2 删除</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> 视图名<span class="token number">1</span><span class="token punctuation">,</span>视图名<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,39),d=[l];function t(i,o){return n(),a("div",null,d)}const r=s(p,[["render",t],["__file","mysql-basic-11.html.vue"]]);export{r as default};
